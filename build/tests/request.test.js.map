{"version":3,"sources":["../../src/tests/request.test.js"],"names":["partyUrl","chai","use","chaiHttp","expect","describe","token","jwt","sign","id","validUser","process","env","JWT_KEY","expiresIn","it","request","app","post","set","send","validRequest","res","status","to","equal","body","message","data"],"mappings":"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","sourcesContent":["/* eslint-disable no-undef */\nimport chai from 'chai'\nimport chaiHttp from 'chai-http'\nimport 'chai/register-should'\nimport jwt from 'jsonwebtoken'\nimport app from '../app'\nimport { populateUser, populateParty, validRequest, validUser, mochAsync, populateInitialParty } from './testData'\n\nconst partyUrl = '/api/v1/parties'\n\nchai.use(chaiHttp)\nconst { expect } = chai\n\ndescribe('Testing the party requests endpoints', () => {\n    const token = jwt.sign({ id: validUser.id }, process.env.JWT_KEY, { expiresIn: '1h' })\n    it(\n        'Should send a party request',\n        mochAsync(async () => {\n            await populateUser()\n            await populateParty()\n            await populateInitialParty()\n            let res = await chai\n                .request(app)\n                .post(`${partyUrl}/2/requests`)\n                .set('Authorization', `Bearer ${token}`)\n                .send(validRequest)\n            expect(res.status).to.equal(201)\n            expect(res.body.message).to.equal('Request successfully sent')\n            expect(res.body.data.status).to.equal('pending')\n        })\n    )\n\n    it(\n        'Should throw a 404 if the party does not exist',\n        mochAsync(async () => {\n            let res = await chai\n                .request(app)\n                .post(`${partyUrl}/4/requests`)\n                .set('Authorization', `Bearer ${token}`)\n                .send(validRequest)\n            expect(res.status).to.equal(404)\n            expect(res.body.message).to.equal('The party you are requesting to attend does not exist.')\n        })\n    )\n\n    it(\n        'Should throw a 400 when a user requests to attend their own party',\n        mochAsync(async () => {\n            let res = await chai\n                .request(app)\n                .post(`${partyUrl}/1/requests`)\n                .set('Authorization', `Bearer ${token}`)\n                .send(validRequest)\n            expect(res.status).to.equal(400)\n            expect(res.body.message).to.equal('You cannot request to attend your own party.')\n        })\n    )\n\n    it(\n        'Should throw a 400 when a user requests to attend a party that they have already requested to attend',\n        mochAsync(async () => {\n            let res = await chai\n                .request(app)\n                .post(`${partyUrl}/2/requests`)\n                .set('Authorization', `Bearer ${token}`)\n                .send(validRequest)\n            expect(res.status).to.equal(400)\n            expect(res.body.message).to.equal('You have already requested to attend this party.')\n        })\n    )\n\n    it(\n        'Should throw a 400 when something wrong happens trying to send a party request',\n        mochAsync(async () => {\n            let res = await chai\n                .request(app)\n                // The url expects an integer but a string is provided\n                .post(`${partyUrl}/invaliddata/requests`)\n                .set('Authorization', `Bearer ${token}`)\n                .send(validRequest)\n            expect(res.status).to.equal(400)\n            expect(res.body.status).to.equal('error')\n        })\n    )\n})\n"],"file":"request.test.js"}